<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>VMware Workstation Pro 中 CentOS 7 啟動崩潰 - Rem Blog</title><meta name="Description" content="HuangNO1&#39;s Blog"><meta property="og:url" content="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/">
  <meta property="og:site_name" content="Rem Blog">
  <meta property="og:title" content="VMware Workstation Pro 中 CentOS 7 啟動崩潰">
  <meta property="og:description" content="前言 我因為最近在做雲計算實驗中的 Hadoop &#43; Spark，我在我的 Windows 上用 VMware Workstation 開了三個虛擬機，且都裝了 CentOS7 系統。當時因為我下課結束將筆電蓋住，去實驗室將電腦打開的時候，整個 Windows 系統變得很卡，視窗方面無法移動縮放，我只好強制關機重啟筆電，結果一開機啟動虛擬機就出錯了。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-12-24T12:17:28+08:00">
    <meta property="article:modified_time" content="2020-12-24T15:10:35+08:00">
    <meta property="article:tag" content="VMware">
    <meta property="article:tag" content="Workstation">
    <meta property="article:tag" content="CentOS">
    <meta property="article:tag" content="Boot">
    <meta property="article:tag" content="Xfs">
    <meta property="og:image" content="https://huangno1.github.io/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://huangno1.github.io/logo.png">
  <meta name="twitter:title" content="VMware Workstation Pro 中 CentOS 7 啟動崩潰">
  <meta name="twitter:description" content="前言 我因為最近在做雲計算實驗中的 Hadoop &#43; Spark，我在我的 Windows 上用 VMware Workstation 開了三個虛擬機，且都裝了 CentOS7 系統。當時因為我下課結束將筆電蓋住，去實驗室將電腦打開的時候，整個 Windows 系統變得很卡，視窗方面無法移動縮放，我只好強制關機重啟筆電，結果一開機啟動虛擬機就出錯了。">
<meta name="application-name" content="Rem Blog">
<meta name="apple-mobile-web-app-title" content="Rem Blog">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/" /><link rel="prev" href="https://huangno1.github.io/leetcode_add_two_numbers/" /><link rel="next" href="https://huangno1.github.io/mysql_learn_note_basic/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "VMware Workstation Pro 中 CentOS 7 啟動崩潰",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/huangno1.github.io\/vmware_centos_fail_boot_xfs_corruption\/"
        },"genre": "posts","keywords": "VMware, Workstation, CentOS, boot, xfs","wordcount":  606 ,
        "url": "https:\/\/huangno1.github.io\/vmware_centos_fail_boot_xfs_corruption\/","datePublished": "2020-12-24T12:17:28+08:00","dateModified": "2020-12-24T15:10:35+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Huang Po-Hsun"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Rem Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icon/avatar.png"
        data-srcset="/icon/avatar.png, /icon/avatar.png 1.5x, /icon/avatar.png 2x"
        data-sizes="auto"
        alt="/icon/avatar.png"
        title="/icon/avatar.png" />Rem Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="https://github.com/HuangNO1" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Rem Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icon/avatar.png"
        data-srcset="/icon/avatar.png, /icon/avatar.png 1.5x, /icon/avatar.png 2x"
        data-sizes="auto"
        alt="/icon/avatar.png"
        title="/icon/avatar.png" />Rem Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="https://github.com/HuangNO1" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">VMware Workstation Pro 中 CentOS 7 啟動崩潰</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://huangno1.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Huang Po-Hsun</a></span>&nbsp;<span class="post-category">included in <a href="/categories/linux/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Linux</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2020-12-24">2020-12-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;606 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;2 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/featuredImage/compressed/vmware_centos_fail_boot_xfs_corruption.png"
        data-srcset="/featuredImage/compressed/vmware_centos_fail_boot_xfs_corruption.png, /featuredImage/compressed/vmware_centos_fail_boot_xfs_corruption.png 1.5x, /featuredImage/compressed/vmware_centos_fail_boot_xfs_corruption.png 2x"
        data-sizes="auto"
        alt="/featuredImage/compressed/vmware_centos_fail_boot_xfs_corruption.png"
        title="/featuredImage/compressed/vmware_centos_fail_boot_xfs_corruption.png" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a></li>
    <li><a href="#問題">問題</a></li>
    <li><a href="#解決">解決</a></li>
    <li><a href="#衍生問題">衍生問題</a></li>
    <li><a href="#結語">結語</a></li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="前言">前言</h2>
<p>我因為最近在做雲計算實驗中的 Hadoop + Spark，我在我的 Windows 上用 VMware Workstation 開了三個虛擬機，且都裝了 CentOS7 系統。當時因為我下課結束將筆電蓋住，去實驗室將電腦打開的時候，整個 Windows 系統變得很卡，視窗方面無法移動縮放，我只好強制關機重啟筆電，結果一開機啟動虛擬機就出錯了。</p>
<h2 id="問題">問題</h2>
<p>我的三台 CentOS 虛擬機都出現 <strong>CentOS 7 Fails to Boot – XFS Corruption – Enters Emergency Mode</strong> 這樣的報錯，看起來是 XFS 文件系統出錯了，錯誤畫面如下：</p>
<p><figure><a class="lightgallery" href="https://imgpoi.com/i/KWPO39.jpg" title="centos_fail_to_boot.jpg" data-thumbnail="https://imgpoi.com/i/KWPO39.jpg" data-sub-html="<h2>CentOS 無法啟動</h2><p>centos_fail_to_boot.jpg</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://imgpoi.com/i/KWPO39.jpg"
            data-srcset="https://imgpoi.com/i/KWPO39.jpg, https://imgpoi.com/i/KWPO39.jpg 1.5x, https://imgpoi.com/i/KWPO39.jpg 2x"
            data-sizes="auto"
            alt="https://imgpoi.com/i/KWPO39.jpg" />
    </a><figcaption class="image-caption">CentOS 無法啟動</figcaption>
    </figure></p>
<p>我嘗試了很久想想怎麼修復，爬文看看是哪裡出錯了，終於在<a href="https://jc-lan.org/2016/11/13/centos-7-fails-to-boot-xfs-corruption-enters-emergency-mode/" target="_blank" rel="noopener noreffer ">一篇文章</a>中找到解決辦法。</p>
<h2 id="解決">解決</h2>
<blockquote>
<p>I chose the default boot option and reached a console. Ideally one should create a dump of the damaged partition by running xfs_metadump, restore the dump to an image using xfs_mdrestore, and then perform the repair on that image. That way you can evaluate the repair done to the image to see if it will work or irreversibly damage your actual data.
I went ahead and just did the repair on the actual data:
<code>xfs_repair -L /dev/mapper/centos-root</code>
The repair completed and after a reboot CentOS started successfully.</p></blockquote>
<p>根據這些內容，於是我在進入的終端裡輸入了<strong>修復鏡像指令</strong>。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-zsh">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">xfs_repair -L /dev/mapper/centos-root</span></span></code></pre></div></div>
<p>接著我輸入 <code>exit</code> 登出後，重新進入系統，結果成功啟動 CentOS 7虛擬機，進入圖形界面也沒問題。</p>
<h2 id="衍生問題">衍生問題</h2>
<p>經過上面的操作後，雖然能正常啟動 CentOS 了，但是卻導致原本可以連網了 CentOS 虛擬機，現在竟然無法連網&hellip;(☉д⊙)，檢查了 VMware 的連網設置，明明設置了 NAT 可以自動連網的呀！？往上一堆奇怪的教學，嘗試了沒用，然後我也不敢直接將物理地址寫死，因為我電腦時常切換網路。</p>
<h2 id="結語">結語</h2>
<p>用虛擬機實在是太不穩了，原本以為解決了啟動問題，為了可能需要將所有實驗重新做一次捏了一把冷汗，最後還是需要新安裝，重新將所有實驗重做一次。我還是 Too Young Too Simple 了。</p>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://jc-lan.org/2016/11/13/centos-7-fails-to-boot-xfs-corruption-enters-emergency-mode/" target="_blank" rel="noopener noreffer ">CentOS 7 Fails to Boot – XFS Corruption – Enters Emergency Mode - JC-LAN</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-12-24</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/vmware_centos_fail_boot_xfs_corruption/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/" data-title="VMware Workstation Pro 中 CentOS 7 啟動崩潰" data-hashtags="VMware,Workstation,CentOS,boot,xfs"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Threads" data-sharer="threads" data-url="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/" data-title="VMware Workstation Pro 中 CentOS 7 啟動崩潰"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/" data-hashtag="VMware"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/" data-title="VMware Workstation Pro 中 CentOS 7 啟動崩潰"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/" data-title="VMware Workstation Pro 中 CentOS 7 啟動崩潰"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/" data-title="VMware Workstation Pro 中 CentOS 7 啟動崩潰" data-image="/featuredImage/compressed/vmware_centos_fail_boot_xfs_corruption.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Diaspora" data-sharer="diaspora" data-url="https://huangno1.github.io/vmware_centos_fail_boot_xfs_corruption/" data-title="VMware Workstation Pro 中 CentOS 7 啟動崩潰" data-description=""><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=https%3a%2f%2fhuangno1.github.io%2fvmware_centos_fail_boot_xfs_corruption%2f&amp;text=VMware%20Workstation%20Pro%20%e4%b8%ad%20CentOS%207%20%e5%95%9f%e5%8b%95%e5%b4%a9%e6%bd%b0" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/vmware/">VMware</a>,&nbsp;<a href="/tags/workstation/">Workstation</a>,&nbsp;<a href="/tags/centos/">CentOS</a>,&nbsp;<a href="/tags/boot/">Boot</a>,&nbsp;<a href="/tags/xfs/">Xfs</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/leetcode_add_two_numbers/" class="prev" rel="prev" title="LeetCode 題庫 - Add Two Numbers (兩數相加)"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>LeetCode 題庫 - Add Two Numbers (兩數相加)</a>
            <a href="/mysql_learn_note_basic/" class="next" rel="next" title="MySQL 的基礎語法使用筆記">MySQL 的基礎語法使用筆記<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://huangno1.github.io" target="_blank">Huang Po-Hsun</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script src="/lib/katex/katex.min.js"></script><script src="/lib/katex/contrib/auto-render.min.js"></script><script src="/lib/katex/contrib/copy-tex.min.js"></script><script src="/lib/katex/contrib/mhchem.min.js"></script><script src="/lib/cookieconsent/cookieconsent.min.js"></script><script>window.config={"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"}};</script><script src="/js/theme.min.js"></script></body>
</html>
