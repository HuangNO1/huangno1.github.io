<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染 - Rem Blog</title><meta name="Description" content=""><meta property="og:title" content="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染" />
<meta property="og:description" content="前言 上一篇文章中我介紹了如何在 RecyclerView 中渲染三種不同的卡片樣式，這次我們加上了數據請求渲染，使該頁面是動態加載的。
Display 請求與渲染展示Display_request_and_render.gif
&#34; 請求與渲染展示 
項目倉庫 簡易今日頭條 - Github
具體實現 關於卡片渲染細節我已經在 RecyclerView 顯示多種寫過了，所以這裡專注於怎麼使用 OkHttp 進行數據請求，與重新回到主 UI Thread 進行卡片渲染。
models/news/NewsDataModel.java 這個類是為了請求回來的數據做一個數據模型，方便後面將數據添入 NewsCardItemDataModel，使邏輯更加清晰。這裡一樣有三種構造函數，分別代表三種不同的卡片類型。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175  package com." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://huangno1.github.io/android_java_request_and_card_list_render/" /><meta property="og:image" content="https://huangno1.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-15T18:03:28+08:00" />
<meta property="article:modified_time" content="2021-06-15T18:03:28+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://huangno1.github.io/logo.png"/>

<meta name="twitter:title" content="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染"/>
<meta name="twitter:description" content="前言 上一篇文章中我介紹了如何在 RecyclerView 中渲染三種不同的卡片樣式，這次我們加上了數據請求渲染，使該頁面是動態加載的。
Display 請求與渲染展示Display_request_and_render.gif
&#34; 請求與渲染展示 
項目倉庫 簡易今日頭條 - Github
具體實現 關於卡片渲染細節我已經在 RecyclerView 顯示多種寫過了，所以這裡專注於怎麼使用 OkHttp 進行數據請求，與重新回到主 UI Thread 進行卡片渲染。
models/news/NewsDataModel.java 這個類是為了請求回來的數據做一個數據模型，方便後面將數據添入 NewsCardItemDataModel，使邏輯更加清晰。這裡一樣有三種構造函數，分別代表三種不同的卡片類型。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175  package com."/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://huangno1.github.io/android_java_request_and_card_list_render/" /><link rel="prev" href="https://huangno1.github.io/android_java_recyclerview_different_cards/" /><link rel="next" href="https://huangno1.github.io/android_java_image_cache_and_lazy_load/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/huangno1.github.io\/android_java_request_and_card_list_render\/"
        },"genre": "posts","keywords": "Android, Java, Android Studio, RecyclerView, Card, List, Adapter, request, OkHttp, Thread, UI, Render","wordcount":  2294 ,
        "url": "https:\/\/huangno1.github.io\/android_java_request_and_card_list_render\/","datePublished": "2021-06-15T18:03:28+08:00","dateModified": "2021-06-15T18:03:28+08:00","publisher": {
            "@type": "Organization",
            "name": "Rem Blog","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/huangno1.github.io\/images\/avatar.png",
                    "width":  528 ,
                    "height":  560 
                }},"author": {
                "@type": "Person",
                "name": "Huang Po-Hsun"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Rem Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp"
        data-srcset="https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp, https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp 1.5x, https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp 2x"
        data-sizes="auto"
        alt="https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp"
        title="https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp" />Rem Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/HuangNO1" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章或標題..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切換主題">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Rem Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp"
        data-srcset="https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp, https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp 1.5x, https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp 2x"
        data-sizes="auto"
        alt="https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp"
        title="https://www.gravatar.com/avatar/1b2e937d26fa273fd402e042f2139949?s=240&amp;d=mp" />Rem Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章或標題..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/HuangNO1" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切換主題">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目錄</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://huangno1.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Huang Po-Hsun</a></span>&nbsp;<span class="post-category">收錄於 <a href="/categories/android/"><i class="far fa-folder fa-fw"></i>Android</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-06-15">2021-06-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;約 2294 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;預計閱讀 11 分鐘&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/featuredImage/compressed/android_image.png"
        data-srcset="/featuredImage/compressed/android_image.png, /featuredImage/compressed/android_image.png 1.5x, /featuredImage/compressed/android_image.png 2x"
        data-sizes="auto"
        alt="/featuredImage/compressed/android_image.png"
        title="/featuredImage/compressed/android_image.png" /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目錄</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a></li>
    <li><a href="#display">Display</a></li>
    <li><a href="#項目倉庫">項目倉庫</a></li>
    <li><a href="#具體實現">具體實現</a>
      <ul>
        <li><a href="#modelsnewsnewsdatamodeljava"><code>models/news/NewsDataModel.java</code></a></li>
        <li><a href="#uipagenewschannelnewschannelfragmentjava"><code>ui/page/newsChannel/newsChannelFragment.java</code></a></li>
      </ul>
    </li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="前言">前言</h2>
<p>上一篇文章中我介紹了如何<a href="https://huangno1.github.io/android_java_recycler_view_different_cards/" target="_blank" rel="noopener noreffer">在 RecyclerView 中渲染三種不同的卡片樣式</a>，這次我們加上了<strong>數據請求渲染</strong>，使該頁面是動態加載的。</p>
<h2 id="display">Display</h2>
<p><figure><a class="lightgallery" href="/android_java_request_and_card_list_render/index/Display_request_and_render.gif" title="Display_request_and_render.gif" data-thumbnail="/android_java_request_and_card_list_render/index/Display_request_and_render.gif" data-sub-html="<h2>請求與渲染展示</h2><p>Display_request_and_render.gif</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="index/Display_request_and_render.gif"
            data-srcset="/android_java_request_and_card_list_render/index/Display_request_and_render.gif, index/Display_request_and_render.gif 1.5x, /android_java_request_and_card_list_render/index/Display_request_and_render.gif 2x"
            data-sizes="auto"
            alt="/android_java_request_and_card_list_render/index/Display_request_and_render.gif" />
    </a><figcaption class="image-caption">請求與渲染展示</figcaption>
    </figure></p>
<h2 id="項目倉庫">項目倉庫</h2>
<p><a href="https://github.com/HuangNO1/TouTiao_Simple_Android_App" target="_blank" rel="noopener noreffer">簡易今日頭條 - Github</a></p>
<h2 id="具體實現">具體實現</h2>
<p>關於卡片渲染細節我已經在 <strong>RecyclerView 顯示多種寫過了</strong>，所以這裡專注於怎麼使用 OkHttp 進行數據請求，與重新回到主 UI Thread 進行卡片渲染。</p>
<h3 id="modelsnewsnewsdatamodeljava"><code>models/news/NewsDataModel.java</code></h3>
<p>這個類是為了請求回來的數據做一個數據模型，方便後面將數據添入 <code>NewsCardItemDataModel</code>，使邏輯更加清晰。這裡一樣有三種構造函數，分別代表三種不同的卡片類型。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.example.toutiao.models.news</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * Data Model Class for news After requesting
</span><span class="cm"> */</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NewsDataModel</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">NO_IMAGE_TYPE</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">ONE_IMAGE_TYPE</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">THREE_IMAGE_TYPE</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
    <span class="c1">// same
</span><span class="c1"></span>    <span class="kd">private</span> <span class="kt">int</span> <span class="n">mNewsCardStyleType</span><span class="o">;</span> <span class="c1">// three different card style
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span> <span class="n">mNewsId</span><span class="o">;</span> <span class="c1">// id
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span> <span class="n">mNewsTitle</span><span class="o">;</span> <span class="c1">// news title
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span> <span class="n">mNewsAbstract</span><span class="o">;</span> <span class="c1">// news abstract
</span><span class="c1"></span>    <span class="kd">private</span> <span class="kt">int</span> <span class="n">mNewsCommentsCount</span><span class="o">;</span> <span class="c1">// comments count
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span> <span class="n">mNewsSource</span><span class="o">;</span> <span class="c1">// author name
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span> <span class="n">mNewsMediaAvatarUrl</span><span class="o">;</span> <span class="c1">// author avatar
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span> <span class="n">mNewsSourceUrl</span><span class="o">;</span> <span class="c1">// detail page url
</span><span class="c1"></span>    <span class="c1">// different
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span> <span class="n">mNewsImageUrl</span><span class="o">;</span> <span class="c1">// one image card style
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">mNewsThreeImage</span><span class="o">;</span> <span class="c1">// three image card style
</span><span class="c1"></span>
    <span class="c1">// no image style constructor
</span><span class="c1"></span>    <span class="kd">public</span> <span class="nf">NewsDataModel</span><span class="o">(</span>
            <span class="kt">int</span> <span class="n">newsCardStyleType</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsId</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsTitle</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsAbstract</span><span class="o">,</span>
            <span class="kt">int</span> <span class="n">newsCommentsCount</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsSource</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsSourceUrl</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsCardStyleType</span> <span class="o">=</span> <span class="n">newsCardStyleType</span><span class="o">;</span>
        <span class="n">mNewsId</span> <span class="o">=</span> <span class="n">newsId</span><span class="o">;</span>
        <span class="n">mNewsTitle</span> <span class="o">=</span> <span class="n">newsTitle</span><span class="o">;</span>
        <span class="n">mNewsAbstract</span> <span class="o">=</span> <span class="n">newsAbstract</span><span class="o">;</span>
        <span class="n">mNewsCommentsCount</span> <span class="o">=</span> <span class="n">newsCommentsCount</span><span class="o">;</span>
        <span class="n">mNewsSource</span> <span class="o">=</span> <span class="n">newsSource</span><span class="o">;</span>
        <span class="n">mNewsMediaAvatarUrl</span> <span class="o">=</span> <span class="n">newsMediaAvatarUrl</span><span class="o">;</span>
        <span class="n">mNewsSourceUrl</span> <span class="o">=</span> <span class="n">newsSourceUrl</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// one image style constructor
</span><span class="c1"></span>    <span class="kd">public</span> <span class="nf">NewsDataModel</span><span class="o">(</span>
            <span class="kt">int</span> <span class="n">newsCardStyleType</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsId</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsTitle</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsAbstract</span><span class="o">,</span>
            <span class="kt">int</span> <span class="n">newsCommentsCount</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsSource</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsSourceUrl</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsImageUrl</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsCardStyleType</span> <span class="o">=</span> <span class="n">newsCardStyleType</span><span class="o">;</span>
        <span class="n">mNewsId</span> <span class="o">=</span> <span class="n">newsId</span><span class="o">;</span>
        <span class="n">mNewsTitle</span> <span class="o">=</span> <span class="n">newsTitle</span><span class="o">;</span>
        <span class="n">mNewsAbstract</span> <span class="o">=</span> <span class="n">newsAbstract</span><span class="o">;</span>
        <span class="n">mNewsCommentsCount</span> <span class="o">=</span> <span class="n">newsCommentsCount</span><span class="o">;</span>
        <span class="n">mNewsSource</span> <span class="o">=</span> <span class="n">newsSource</span><span class="o">;</span>
        <span class="n">mNewsMediaAvatarUrl</span> <span class="o">=</span> <span class="n">newsMediaAvatarUrl</span><span class="o">;</span>
        <span class="n">mNewsSourceUrl</span> <span class="o">=</span> <span class="n">newsSourceUrl</span><span class="o">;</span>
        <span class="n">mNewsImageUrl</span> <span class="o">=</span> <span class="n">newsImageUrl</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// three image style constructor
</span><span class="c1"></span>    <span class="kd">public</span> <span class="nf">NewsDataModel</span><span class="o">(</span>
            <span class="kt">int</span> <span class="n">newsCardStyleType</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsId</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsTitle</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsAbstract</span><span class="o">,</span>
            <span class="kt">int</span> <span class="n">newsCommentsCount</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsSource</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">newsSourceUrl</span><span class="o">,</span>
            <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">newsThreeImage</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsCardStyleType</span> <span class="o">=</span> <span class="n">newsCardStyleType</span><span class="o">;</span>
        <span class="n">mNewsId</span> <span class="o">=</span> <span class="n">newsId</span><span class="o">;</span>
        <span class="n">mNewsTitle</span> <span class="o">=</span> <span class="n">newsTitle</span><span class="o">;</span>
        <span class="n">mNewsAbstract</span> <span class="o">=</span> <span class="n">newsAbstract</span><span class="o">;</span>
        <span class="n">mNewsCommentsCount</span> <span class="o">=</span> <span class="n">newsCommentsCount</span><span class="o">;</span>
        <span class="n">mNewsSource</span> <span class="o">=</span> <span class="n">newsSource</span><span class="o">;</span>
        <span class="n">mNewsMediaAvatarUrl</span> <span class="o">=</span> <span class="n">newsMediaAvatarUrl</span><span class="o">;</span>
        <span class="n">mNewsSourceUrl</span> <span class="o">=</span> <span class="n">newsSourceUrl</span><span class="o">;</span>
        <span class="n">mNewsThreeImage</span> <span class="o">=</span> <span class="n">newsThreeImage</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getNewsCardStyleType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsCardStyleType</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsCardStyleType</span><span class="o">(</span><span class="kt">int</span> <span class="n">newsCardStyleType</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsCardStyleType</span> <span class="o">=</span> <span class="n">newsCardStyleType</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNewsId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsId</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsId</span><span class="o">(</span><span class="n">String</span> <span class="n">newsId</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsId</span> <span class="o">=</span> <span class="n">newsId</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNewsTitle</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsTitle</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsTitle</span><span class="o">(</span><span class="n">String</span> <span class="n">newsTitle</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsTitle</span> <span class="o">=</span> <span class="n">newsTitle</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNewsAbstract</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsAbstract</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsAbstract</span><span class="o">(</span><span class="n">String</span> <span class="n">newsAbstract</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsAbstract</span> <span class="o">=</span> <span class="n">newsAbstract</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getNewsCommentsCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsCommentsCount</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsCommentsCount</span><span class="o">(</span><span class="kt">int</span> <span class="n">newsCommentsCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsCommentsCount</span> <span class="o">=</span> <span class="n">newsCommentsCount</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNewsSource</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsSource</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsSource</span><span class="o">(</span><span class="n">String</span> <span class="n">newsSource</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsSource</span> <span class="o">=</span> <span class="n">newsSource</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNewsMediaAvatarUrl</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsMediaAvatarUrl</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsMediaAvatarUrl</span><span class="o">(</span><span class="n">String</span> <span class="n">newsMediaAvatarUrl</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsMediaAvatarUrl</span> <span class="o">=</span> <span class="n">newsMediaAvatarUrl</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNewsSourceUrl</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsSourceUrl</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsSourceUrl</span><span class="o">(</span><span class="n">String</span> <span class="n">newsSourceUrl</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsSourceUrl</span> <span class="o">=</span> <span class="n">newsSourceUrl</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNewsImageUrl</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsImageUrl</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsImageUrl</span><span class="o">(</span><span class="n">String</span> <span class="n">newsImageUrl</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mNewsImageUrl</span> <span class="o">=</span> <span class="n">newsImageUrl</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getNewsThreeImage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mNewsThreeImage</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/*
</span><span class="cm">     * add a image to mNewsThreeImage array list
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewsThreeImage</span><span class="o">(</span><span class="n">String</span> <span class="n">newsImageUrl</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">mNewsThreeImage</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">newsImageUrl</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="uipagenewschannelnewschannelfragmentjava"><code>ui/page/newsChannel/newsChannelFragment.java</code></h3>
<p>這裡是我們需要進行新聞內容請求的 Fragment。我使用的是 OkHttp 的方法，如果不知道 OkHttp 可以去 Github 看看 <a href="https://github.com/square/okhttp" target="_blank" rel="noopener noreffer">square/okhttp - github</a>。</p>
<p>引入依賴需要在 <code>build.gradle</code> 中加上下面一段話：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">dependencies {
	// ...
    implementation &#39;com.squareup.okhttp3:okhttp:4.9.1&#39;
}
</code></pre></td></tr></table>
</div>
</div><p><strong>注意：為了能夠進行網路請求需要在 <code>/manifests/AndroidManifest.xml</code> 中加上  <code>&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;</code> 這段話。</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&#34;http://schemas.android.com/apk/res/android&#34;</span>
    <span class="na">package=</span><span class="s">&#34;com.example.toutiao&#34;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&#34;android.permission.INTERNET&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&#34;android.permission.ACCESS_NETWORK_STATE&#34;</span> <span class="nt">/&gt;</span>
// ...
</code></pre></td></tr></table>
</div>
</div><p>下面的 Code 中我分別使用 <code>getUserAgent()</code> 固定 UA，<code>getInitNews()</code> 請求新聞數據，<code>initRenderCardList()</code> 做數據渲染，<code>dealWithResponseBody()</code> 處理請求回來的 <code>ResponseBody</code>，<code>dealWithNewsObject()</code> 處理每個新聞列表，<code>mHandler</code> 負責請求後回到在主 UI 線程裡面進行渲染（也就是<code>initRenderCardList()</code>），這裡的注意點有：</p>
<ol>
<li>
<p>除了固定 UA 外，需要將請求回來的 <strong><code>Response</code> 中 <code>Header</code> 的 <code>Set-Cookie</code></strong> 加入下一次請求中的 Cookie，這樣避免了<strong>請求回來的數據與原數據重複性</strong>。</p>
</li>
<li>
<p>請求必須使用多線程的方式進行異步請求，不能在 UI 主線程請求，這是新的 Android 規定，所以我建議可以使用 <strong><code>AsyncTask</code></strong> 或是 <strong>Okhttp 的異步回調方法</strong>。我下面的 Example 是使用了後者。</p>
</li>
<li>
<p>OkHttp 中<strong>異步請求的 <code>response.body().string()</code> 只能使用一次</strong>，使用完一次後就會將回應 Body 刪除節省資源（我也不知道為什麼要這樣設計），所以需要先存成 <code>String</code> 類型，再接著使用。</p>
</li>
<li>
<p>注意<strong>處理每一次數據，檢查是否有些數據不完整</strong>，或是 ResponseBody 是空的情況都需要考慮，如果沒有考慮到，就會經常在運行項目時<strong>產生 Crash</strong>。</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.example.toutiao.ui.page.newsChannel</span><span class="o">;</span>

<span class="c1">// ...
</span><span class="c1"></span>
<span class="kn">import</span> <span class="nn">okhttp3.Call</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">okhttp3.Callback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">okhttp3.OkHttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">okhttp3.Request</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">okhttp3.Response</span><span class="o">;</span>

<span class="kn">import static</span> <span class="nn">com.example.toutiao.ui.card.newsCardList.NewsCardItemDataModel.NO_IMAGE_TYPE</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">com.example.toutiao.ui.card.newsCardList.NewsCardItemDataModel.ONE_IMAGE_TYPE</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">com.example.toutiao.ui.card.newsCardList.NewsCardItemDataModel.THREE_IMAGE_TYPE</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * A simple {@link Fragment} subclass.
</span><span class="cm"> * Use the {@link NewsChannelFragment#newInstance} factory method to
</span><span class="cm"> * create an instance of this fragment.
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NewsChannelFragment</span> <span class="kd">extends</span> <span class="n">Fragment</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">BASE_URL</span> <span class="o">=</span>
            <span class="s">&#34;https://www.toutiao.com/api/pc/feed/?max_behot_time=%d&amp;category=%s&#34;</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">CATEGORY_ATTR</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span>
            <span class="s">&#34;__all__&#34;</span><span class="o">,</span>
            <span class="s">&#34;news_tech&#34;</span><span class="o">,</span>
<span class="c1">//            &#34;news_image&#34;,
</span><span class="c1"></span>            <span class="s">&#34;news_hot&#34;</span><span class="o">,</span>
            <span class="s">&#34;news_entertainment&#34;</span><span class="o">,</span>
            <span class="s">&#34;news_game&#34;</span><span class="o">,</span>
            <span class="s">&#34;news_sports&#34;</span><span class="o">,</span>
            <span class="s">&#34;news_finance&#34;</span><span class="o">,</span>
            <span class="s">&#34;digital&#34;</span>
    <span class="o">};</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DEFAULT_AVATAR</span> <span class="o">=</span>
            <span class="s">&#34;https://img.88icon.com/download/jpg/20200901/84083236c883964781afea41f1ea4e9c_512_511.jpg!88bg&#34;</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DEFAULT_IMAGE</span> <span class="o">=</span>
            <span class="s">&#34;https://www.asiapacdigital.com/Zh_Cht/img/ap/services/reseller/TouTiao_1.jpg&#34;</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">INIT_OR_REFRESH</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LOAD_MORE</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LOAD_FAIL</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">NewsDataModel</span><span class="o">&gt;</span> <span class="n">mNewsDataModelList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="kd">private</span> <span class="n">PageViewModel</span> <span class="n">mPageViewModel</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">RecyclerView</span> <span class="n">mCardListRecyclerView</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">NewsCardAdapter</span> <span class="n">mCardListAdapter</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">LayoutManager</span> <span class="n">mCardListLayoutManager</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Boolean</span> <span class="n">mIsScrollToTop</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">NewsCardItemDataModel</span><span class="o">&gt;</span> <span class="n">mCardDataModelList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">mCategory</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">mIndex</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">mIsRefresh</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">mIsLoadMore</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">mIsLoadingFail</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">mMaxBehotTime</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">mCookie</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">NewsChannelFragment</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="cm">/**
</span><span class="cm">     * Use this factory method to create a new instance of
</span><span class="cm">     * this fragment using the provided parameters.
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">NewsChannelFragment</span> <span class="nf">newInstance</span><span class="o">(</span><span class="n">String</span> <span class="n">category</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">NewsChannelFragment</span> <span class="n">fragment</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NewsChannelFragment</span><span class="o">();</span>
        <span class="n">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bundle</span><span class="o">();</span>
        <span class="n">bundle</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="s">&#34;category&#34;</span><span class="o">,</span> <span class="n">category</span><span class="o">);</span>
        <span class="n">bundle</span><span class="o">.</span><span class="na">putInt</span><span class="o">(</span><span class="s">&#34;index&#34;</span><span class="o">,</span> <span class="n">index</span><span class="o">);</span>
        <span class="n">fragment</span><span class="o">.</span><span class="na">setArguments</span><span class="o">(</span><span class="n">bundle</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">fragment</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">mPageViewModel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ViewModelProvider</span><span class="o">(</span><span class="k">this</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="n">PageViewModel</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">getArguments</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">mCategory</span> <span class="o">=</span> <span class="n">getArguments</span><span class="o">().</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;category&#34;</span><span class="o">);</span>
            <span class="n">mIndex</span> <span class="o">=</span> <span class="n">getArguments</span><span class="o">().</span><span class="na">getInt</span><span class="o">(</span><span class="s">&#34;index&#34;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">mPageViewModel</span><span class="o">.</span><span class="na">setCategory</span><span class="o">(</span><span class="n">mCategory</span><span class="o">);</span>
        <span class="n">mPageViewModel</span><span class="o">.</span><span class="na">setIndex</span><span class="o">(</span><span class="n">mIndex</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">View</span> <span class="nf">onCreateView</span><span class="o">(</span><span class="n">LayoutInflater</span> <span class="n">inflater</span><span class="o">,</span> <span class="n">ViewGroup</span> <span class="n">container</span><span class="o">,</span>
                             <span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">View</span> <span class="n">view</span> <span class="o">=</span> <span class="n">inflater</span><span class="o">.</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">fragment_news_channel</span><span class="o">,</span> <span class="n">container</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
        <span class="c1">// cardList
</span><span class="c1"></span>        <span class="n">mCardListRecyclerView</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">recycler_view_card_list</span><span class="o">);</span>

        <span class="c1">// use this setting to improve performance if you know that changes
</span><span class="c1"></span>        <span class="c1">// in content do not change the layout size of the RecyclerView
</span><span class="c1"></span>        <span class="n">mCardListRecyclerView</span><span class="o">.</span><span class="na">setHasFixedSize</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="c1">// use a linear layout manager
</span><span class="c1"></span>        <span class="n">mCardListLayoutManager</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinearLayoutManager</span><span class="o">(</span><span class="n">getContext</span><span class="o">());</span>
        <span class="n">mCardListRecyclerView</span><span class="o">.</span><span class="na">setLayoutManager</span><span class="o">(</span><span class="n">mCardListLayoutManager</span><span class="o">);</span>

        <span class="c1">// specify an adapter and pass in our data model list
</span><span class="c1"></span>        <span class="n">mCardListAdapter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NewsCardAdapter</span><span class="o">(</span><span class="n">mCardDataModelList</span><span class="o">,</span> <span class="n">getContext</span><span class="o">());</span>
        <span class="n">mCardListRecyclerView</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">mCardListAdapter</span><span class="o">);</span>

        <span class="n">TextView</span> <span class="n">mSectionLabelTextView</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">text_view_section_label</span><span class="o">);</span>

        <span class="c1">// init
</span><span class="c1"></span>        <span class="n">getInitNews</span><span class="o">();</span>

        <span class="n">mPageViewModel</span><span class="o">.</span><span class="na">getCategory</span><span class="o">().</span><span class="na">observe</span><span class="o">(</span><span class="n">getViewLifecycleOwner</span><span class="o">(),</span> <span class="k">new</span> <span class="n">Observer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onChanged</span><span class="o">(</span><span class="nd">@Nullable</span> <span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">mSectionLabelTextView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="k">return</span> <span class="n">view</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// render the recycler view card list when init and refreshing
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initRenderCardList</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;start init render&#34;</span><span class="o">,</span> <span class="s">&#34;render init card, news list size: &#34;</span> <span class="o">+</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">type</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsCardStyleType</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">newsId</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsId</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">newsTitle</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsTitle</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">newsAbstract</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsAbstract</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">newsCommentsCount</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsCommentsCount</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">newsSource</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsSource</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">newsMediaAvatarUrl</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsMediaAvatarUrl</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">newsSourceUrl</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsSourceUrl</span><span class="o">();</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">NO_IMAGE_TYPE</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">mCardDataModelList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">NewsCardItemDataModel</span><span class="o">(</span>
                        <span class="n">NO_IMAGE_TYPE</span><span class="o">,</span>
                        <span class="n">newsId</span><span class="o">,</span>
                        <span class="n">newsTitle</span><span class="o">,</span>
                        <span class="n">newsAbstract</span><span class="o">,</span>
                        <span class="n">newsCommentsCount</span><span class="o">,</span>
                        <span class="n">newsSource</span><span class="o">,</span>
                        <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
                        <span class="n">newsSourceUrl</span>
                <span class="o">));</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">ONE_IMAGE_TYPE</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">middleImage</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsImageUrl</span><span class="o">();</span>
                <span class="n">mCardDataModelList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">NewsCardItemDataModel</span><span class="o">(</span>
                        <span class="n">ONE_IMAGE_TYPE</span><span class="o">,</span>
                        <span class="n">newsId</span><span class="o">,</span>
                        <span class="n">newsTitle</span><span class="o">,</span>
                        <span class="n">newsAbstract</span><span class="o">,</span>
                        <span class="n">newsCommentsCount</span><span class="o">,</span>
                        <span class="n">newsSource</span><span class="o">,</span>
                        <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
                        <span class="n">newsSourceUrl</span><span class="o">,</span>
                        <span class="n">middleImage</span>
                <span class="o">));</span>

            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">THREE_IMAGE_TYPE</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">newsThreeImage</span> <span class="o">=</span> <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNewsThreeImage</span><span class="o">();</span>
                <span class="n">mCardDataModelList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">NewsCardItemDataModel</span><span class="o">(</span>
                        <span class="n">THREE_IMAGE_TYPE</span><span class="o">,</span>
                        <span class="n">newsId</span><span class="o">,</span>
                        <span class="n">newsTitle</span><span class="o">,</span>
                        <span class="n">newsAbstract</span><span class="o">,</span>
                        <span class="n">newsCommentsCount</span><span class="o">,</span>
                        <span class="n">newsSource</span><span class="o">,</span>
                        <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
                        <span class="n">newsSourceUrl</span><span class="o">,</span>
                        <span class="n">newsThreeImage</span>
                <span class="o">));</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">mLoadingAnimationView</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">GONE</span><span class="o">);</span>
        <span class="n">mScreenMaskView</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">GONE</span><span class="o">);</span>
        <span class="n">mCardListRefreshLayout</span><span class="o">.</span><span class="na">finishRefreshing</span><span class="o">();</span>
        <span class="n">mCardListAdapter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NewsCardAdapter</span><span class="o">(</span><span class="n">mCardDataModelList</span><span class="o">,</span> <span class="n">getContext</span><span class="o">());</span>
        <span class="n">mCardListRecyclerView</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">mCardListAdapter</span><span class="o">);</span>

        <span class="n">mIsRefresh</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="nf">getUserAgent</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">userAgent</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">userAgent</span> <span class="o">=</span> <span class="n">WebSettings</span><span class="o">.</span><span class="na">getDefaultUserAgent</span><span class="o">(</span><span class="n">getContext</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">userAgent</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;https.agent&#34;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">StringBuffer</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">userAgent</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="n">userAgent</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;\u001f&#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="sc">&#39;\u007f&#39;</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&#34;\\u%04x&#34;</span><span class="o">,</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">c</span><span class="o">));</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**
</span><span class="cm">     * a methods to init card list
</span><span class="cm">     *
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getInitNews</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// init data
</span><span class="c1"></span>        <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
        <span class="n">mCardDataModelList</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
        <span class="n">mLoadingAnimationView</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">VISIBLE</span><span class="o">);</span>
        <span class="n">mMaxBehotTime</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="c1">// setting request
</span><span class="c1"></span>        <span class="n">OkHttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OkHttpClient</span><span class="o">();</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;request url&#34;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">Locale</span><span class="o">.</span><span class="na">ENGLISH</span><span class="o">,</span> <span class="n">BASE_URL</span><span class="o">,</span> <span class="n">mMaxBehotTime</span><span class="o">,</span> <span class="n">CATEGORY_ATTR</span><span class="o">[</span><span class="n">mIndex</span><span class="o">]));</span>
        <span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Request</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">get</span><span class="o">()</span>
                <span class="o">.</span><span class="na">url</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">Locale</span><span class="o">.</span><span class="na">ENGLISH</span><span class="o">,</span> <span class="n">BASE_URL</span><span class="o">,</span> <span class="n">mMaxBehotTime</span><span class="o">,</span> <span class="n">CATEGORY_ATTR</span><span class="o">[</span><span class="n">mIndex</span><span class="o">]))</span>
                <span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">&#34;User-Agent&#34;</span><span class="o">,</span> <span class="n">getUserAgent</span><span class="o">())</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="n">Call</span> <span class="n">call</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">newCall</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>

        <span class="n">call</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="k">new</span> <span class="n">Callback</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="nd">@NotNull</span> <span class="n">Call</span> <span class="n">call</span><span class="o">,</span> <span class="nd">@NotNull</span> <span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResponse</span><span class="o">(</span><span class="nd">@NotNull</span> <span class="n">Call</span> <span class="n">call</span><span class="o">,</span> <span class="nd">@NotNull</span> <span class="kd">final</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;json status&#34;</span><span class="o">,</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="n">response</span><span class="o">.</span><span class="na">code</span><span class="o">());</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;json body&#34;</span><span class="o">,</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">body</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">));</span>
                <span class="n">String</span> <span class="n">jsonData</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">body</span><span class="o">().</span><span class="na">string</span><span class="o">();</span>
                <span class="c1">// deal with request body
</span><span class="c1"></span>                <span class="n">dealWithResponseBody</span><span class="o">(</span><span class="n">jsonData</span><span class="o">);</span>
                <span class="n">mCookie</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">&#34;Set-Cookie&#34;</span><span class="o">);</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;cookie&#34;</span><span class="o">,</span> <span class="s">&#34;set cookie: &#34;</span> <span class="o">+</span> <span class="n">mCookie</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="cm">/**
</span><span class="cm">     * @param jsonData
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dealWithResponseBody</span><span class="o">(</span><span class="n">String</span> <span class="n">jsonData</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// avoid that jsonData is null
</span><span class="c1"></span>        <span class="k">if</span><span class="o">(</span><span class="n">jsonData</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">mIsLoadingFail</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="c1">// run on main ui thread
</span><span class="c1"></span>            <span class="n">mHander</span><span class="o">.</span><span class="na">sendEmptyMessage</span><span class="o">(</span><span class="n">LOAD_FAIL</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with response&#34;</span><span class="o">,</span> <span class="s">&#34;string to JsonObject&#34;</span><span class="o">);</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with response&#34;</span><span class="o">,</span> <span class="s">&#34;json data\n&#34;</span> <span class="o">+</span> <span class="n">jsonData</span><span class="o">);</span>
        <span class="n">JsonObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">JsonParser</span><span class="o">.</span><span class="na">parseString</span><span class="o">(</span><span class="n">jsonData</span><span class="o">).</span><span class="na">getAsJsonObject</span><span class="o">();</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with response&#34;</span><span class="o">,</span> <span class="s">&#34;result, before max_behot_time &#34;</span> <span class="o">+</span> <span class="n">mMaxBehotTime</span><span class="o">);</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with response&#34;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">getAsJsonObject</span><span class="o">(</span><span class="s">&#34;next&#34;</span><span class="o">).</span><span class="na">has</span><span class="o">(</span><span class="s">&#34;max_behot_time&#34;</span><span class="o">)));</span>
        <span class="n">mMaxBehotTime</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getAsJsonObject</span><span class="o">(</span><span class="s">&#34;next&#34;</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;max_behot_time&#34;</span><span class="o">).</span><span class="na">getAsInt</span><span class="o">();</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with response&#34;</span><span class="o">,</span> <span class="s">&#34;After max_behot_time : &#34;</span> <span class="o">+</span> <span class="n">mMaxBehotTime</span> <span class="o">+</span> <span class="s">&#34; get news object&#34;</span><span class="o">);</span>
        <span class="n">JsonArray</span> <span class="n">newsData</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getAsJsonArray</span><span class="o">(</span><span class="s">&#34;data&#34;</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">newsData</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with response&#34;</span><span class="o">,</span> <span class="s">&#34;newsObjects &#34;</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>
            <span class="n">dealWithNewsObject</span><span class="o">(</span><span class="n">newsData</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getAsJsonObject</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">mHander</span><span class="o">.</span><span class="na">sendEmptyMessage</span><span class="o">(</span><span class="n">INIT_OR_REFRESH</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
</span><span class="cm">     * running on main UI thread to render card list
</span><span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Handler</span> <span class="n">mHander</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">(</span><span class="k">new</span> <span class="n">Handler</span><span class="o">.</span><span class="na">Callback</span><span class="o">()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">handleMessage</span><span class="o">(</span><span class="nd">@NonNull</span> <span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">what</span> <span class="o">==</span> <span class="n">INIT_OR_REFRESH</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">initRenderCardList</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">what</span> <span class="o">==</span> <span class="n">LOAD_MORE</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">loadMoreRenderCardList</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">what</span> <span class="o">==</span> <span class="n">LOAD_FAIL</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">loadingFail</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">});</span>

    <span class="cm">/**
</span><span class="cm">     * a methods to transfer JsonObject to NewsDataModel
</span><span class="cm">     *
</span><span class="cm">     * @param object
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dealWithNewsObject</span><span class="o">(</span><span class="n">JsonObject</span> <span class="n">object</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">NewsDataModel</span> <span class="n">temp</span><span class="o">;</span>
        <span class="c1">// id
</span><span class="c1"></span>        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with news object&#34;</span><span class="o">,</span> <span class="s">&#34;news_id &#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;group_id&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">());</span>
        <span class="n">String</span> <span class="n">newsId</span> <span class="o">=</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;group_id&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">();</span>
        <span class="c1">// title
</span><span class="c1"></span>        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with news object&#34;</span><span class="o">,</span> <span class="s">&#34;news_title &#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;title&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">());</span>
        <span class="n">String</span> <span class="n">newsTitle</span> <span class="o">=</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;title&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">();</span>
        <span class="c1">// remove \r \n \t
</span><span class="c1"></span>        <span class="n">newsTitle</span> <span class="o">=</span> <span class="n">newsTitle</span><span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&#34;\r|\n|\t&#34;</span><span class="o">,</span> <span class="s">&#34;&#34;</span><span class="o">);</span>
        <span class="c1">// abstract
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">newsAbstract</span> <span class="o">=</span> <span class="n">newsTitle</span><span class="o">;</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with news object&#34;</span><span class="o">,</span> <span class="s">&#34;news_abstract &#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&#34;abstract&#34;</span><span class="o">));</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">object</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&#34;abstract&#34;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">newsAbstract</span> <span class="o">=</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;abstract&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">();</span>
            <span class="c1">// remove \r \n \t
</span><span class="c1"></span>            <span class="n">newsAbstract</span> <span class="o">=</span> <span class="n">newsAbstract</span><span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&#34;\r|\n|\t&#34;</span><span class="o">,</span> <span class="s">&#34;&#34;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// comments count
</span><span class="c1"></span>        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with news object&#34;</span><span class="o">,</span> <span class="s">&#34;news_comments_count &#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&#34;comments_count&#34;</span><span class="o">));</span>
        <span class="kt">int</span> <span class="n">newsCommentsCount</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">object</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&#34;comments_count&#34;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">newsCommentsCount</span> <span class="o">=</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;comments_count&#34;</span><span class="o">).</span><span class="na">getAsInt</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="c1">// news source
</span><span class="c1"></span>        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with news object&#34;</span><span class="o">,</span> <span class="s">&#34;news_source &#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;source&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">());</span>
        <span class="n">String</span> <span class="n">newsSource</span> <span class="o">=</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;source&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">();</span>
        <span class="c1">// news media avatar url
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">newsMediaAvatarUrl</span> <span class="o">=</span> <span class="n">DEFAULT_AVATAR</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">object</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&#34;media_avatar_url&#34;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">newsMediaAvatarUrl</span> <span class="o">=</span> <span class="s">&#34;https:&#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;media_avatar_url&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="c1">// news source url
</span><span class="c1"></span>        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with news object&#34;</span><span class="o">,</span> <span class="s">&#34;news_source_url &#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;source_url&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">());</span>
        <span class="n">String</span> <span class="n">newsSourceUrl</span> <span class="o">=</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;source_url&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">();</span>

        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with news object&#34;</span><span class="o">,</span> <span class="s">&#34;have image_list &#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&#34;image_list&#34;</span><span class="o">));</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">&#34;deal with news object&#34;</span><span class="o">,</span> <span class="s">&#34;single_mode &#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;single_mode&#34;</span><span class="o">).</span><span class="na">getAsBoolean</span><span class="o">());</span>
        <span class="c1">// three image style
</span><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">object</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&#34;image_list&#34;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">JsonArray</span> <span class="n">imageList</span> <span class="o">=</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;image_list&#34;</span><span class="o">).</span><span class="na">getAsJsonArray</span><span class="o">();</span>
            <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">newsThreeImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

            <span class="c1">// the Json Array is not null
</span><span class="c1"></span>            <span class="k">if</span><span class="o">(</span><span class="n">imageList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">3</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">3</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="c1">// avoid url is null
</span><span class="c1"></span>                    <span class="n">newsThreeImage</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">DEFAULT_IMAGE</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">3</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="c1">// avoid url is null
</span><span class="c1"></span>                    <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">imageList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getAsJsonObject</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;url&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">();</span>
                    <span class="k">if</span><span class="o">(</span><span class="n">url</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">url</span> <span class="o">=</span> <span class="n">DEFAULT_IMAGE</span><span class="o">;</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="n">url</span> <span class="o">=</span> <span class="s">&#34;https:&#34;</span> <span class="o">+</span> <span class="n">url</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="n">newsThreeImage</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NewsDataModel</span><span class="o">(</span>
                    <span class="n">NewsDataModel</span><span class="o">.</span><span class="na">THREE_IMAGE_TYPE</span><span class="o">,</span>
                    <span class="n">newsId</span><span class="o">,</span>
                    <span class="n">newsTitle</span><span class="o">,</span>
                    <span class="n">newsAbstract</span><span class="o">,</span>
                    <span class="n">newsCommentsCount</span><span class="o">,</span>
                    <span class="n">newsSource</span><span class="o">,</span>
                    <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
                    <span class="n">newsSourceUrl</span><span class="o">,</span>
                    <span class="n">newsThreeImage</span>
            <span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// one image style
</span><span class="c1"></span>        <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;single_mode&#34;</span><span class="o">).</span><span class="na">getAsBoolean</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">middleImage</span> <span class="o">=</span> <span class="s">&#34;https:&#34;</span> <span class="o">+</span> <span class="n">object</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;image_url&#34;</span><span class="o">).</span><span class="na">getAsString</span><span class="o">();</span>

            <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NewsDataModel</span><span class="o">(</span>
                    <span class="n">NewsDataModel</span><span class="o">.</span><span class="na">ONE_IMAGE_TYPE</span><span class="o">,</span>
                    <span class="n">newsId</span><span class="o">,</span>
                    <span class="n">newsTitle</span><span class="o">,</span>
                    <span class="n">newsAbstract</span><span class="o">,</span>
                    <span class="n">newsCommentsCount</span><span class="o">,</span>
                    <span class="n">newsSource</span><span class="o">,</span>
                    <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
                    <span class="n">newsSourceUrl</span><span class="o">,</span>
                    <span class="n">middleImage</span>
            <span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// no image style
</span><span class="c1"></span>        <span class="k">else</span> <span class="o">{</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NewsDataModel</span><span class="o">(</span>
                    <span class="n">NewsDataModel</span><span class="o">.</span><span class="na">NO_IMAGE_TYPE</span><span class="o">,</span>
                    <span class="n">newsId</span><span class="o">,</span>
                    <span class="n">newsTitle</span><span class="o">,</span>
                    <span class="n">newsAbstract</span><span class="o">,</span>
                    <span class="n">newsCommentsCount</span><span class="o">,</span>
                    <span class="n">newsSource</span><span class="o">,</span>
                    <span class="n">newsMediaAvatarUrl</span><span class="o">,</span>
                    <span class="n">newsSourceUrl</span>
            <span class="o">);</span>
        <span class="o">}</span>
        <span class="n">mNewsDataModelList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">temp</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="reference">Reference</h2>
<ul>
<li><a href="https://github.com/HuangNO1/TouTiao_Simple_Android_App" target="_blank" rel="noopener noreffer">簡易今日頭條 - Github</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-06-15</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/android_java_request_and_card_list_render/index.md" target="_blank">閱讀原始檔案</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://huangno1.github.io/android_java_request_and_card_list_render/" data-title="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染" data-via="Rem59881439" data-hashtags="Android,Java,Android Studio,RecyclerView,Card,List,Adapter,request,OkHttp,Thread,UI,Render"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://huangno1.github.io/android_java_request_and_card_list_render/" data-hashtag="Android"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="https://huangno1.github.io/android_java_request_and_card_list_render/" data-title="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://huangno1.github.io/android_java_request_and_card_list_render/" data-title="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://huangno1.github.io/android_java_request_and_card_list_render/" data-title="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染" data-image="/featuredImage/compressed/android_image.png"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Myspace" data-sharer="myspace" data-url="https://huangno1.github.io/android_java_request_and_card_list_render/" data-title="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="https://huangno1.github.io/android_java_request_and_card_list_render/" data-title="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="https://huangno1.github.io/android_java_request_and_card_list_render/" data-title="Android Java - 簡易今日頭條 - 新聞數據請求與卡片渲染"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/android/">Android</a>,&nbsp;<a href="/tags/java/">Java</a>,&nbsp;<a href="/tags/android-studio/">Android Studio</a>,&nbsp;<a href="/tags/recyclerview/">RecyclerView</a>,&nbsp;<a href="/tags/card/">Card</a>,&nbsp;<a href="/tags/list/">List</a>,&nbsp;<a href="/tags/adapter/">Adapter</a>,&nbsp;<a href="/tags/request/">request</a>,&nbsp;<a href="/tags/okhttp/">OkHttp</a>,&nbsp;<a href="/tags/thread/">Thread</a>,&nbsp;<a href="/tags/ui/">UI</a>,&nbsp;<a href="/tags/render/">Render</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主頁</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/android_java_recyclerview_different_cards/" class="prev" rel="prev" title="Android Java - 簡易今日頭條 - RecyclerView 渲染多種不同樣式的新聞卡片"><i class="fas fa-angle-left fa-fw"></i>Android Java - 簡易今日頭條 - RecyclerView 渲染多種不同樣式的新聞卡片</a>
            <a href="/android_java_image_cache_and_lazy_load/" class="next" rel="next" title="Android Java - 簡易今日頭條 - 圖片緩存與懶加載">Android Java - 簡易今日頭條 - 圖片緩存與懶加載<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.88.1">Hugo</a> 強力驅動 | 主題 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://huangno1.github.io" target="_blank">Huang Po-Hsun</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到頂部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看評論">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="https://remblog.disqus.com/embed.js" defer></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"複製到剪貼簿","maxShownLines":10},"comment":{},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本網站使用 Cookies 來改善你的瀏覽體驗."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"沒有找到結果","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-138697151-2', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-138697151-2" async></script></body>
</html>
